const areas = {
  pacha: [
    {
      name: "ignacio aguilar",
      quantity: "1000",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "pacha 1",
    },
    {
      name: "ignacio aguilar",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "pacha 2",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "pacha 3",
    },
    {
      name: "mama",
      quantity: "1000",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "pacha 4",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "pacha 5",
    },
    {
      name: "pacha sunset",
      quantity: "500",
      drinks: "parrales,",
      combos: "banx",
      mesa: "pacha 6",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "pacha 7",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "pacha 8",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "pacha 9",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "pacha 10",
    },
  ],

  lounge: [
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "viuda descalza,parrales",
      combos: "cumpleañero",
      mesa: "lounge 1",
    },
    {
      name: "mama",
      quantity: "1100",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "lounge 2",
    },
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "parrales,fernet buhero",
      combos: "cascabel",
      mesa: "lounge 3",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "lounge 4",
    },
    {
      name: "pacha sunset",
      quantity: "450",
      drinks: "parrales,",
      combos: "banx",
      mesa: "lounge 5",
    },
    {
      name: "pacha sunset",
      quantity: "500",
      drinks: "parrales,",
      combos: "banx",
      mesa: "lounge 6",
    },
    {
      name: "mama",
      quantity: "1100",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "lounge 7",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "lounge 8",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "lounge 9",
    },
    {
      name: "mama",
      quantity: "1000",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "lounge 10",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "lounge 11",
    },
  ],

  parrales: [
    {
      name: "pacha sunset",
      quantity: "900",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 1",
    },
    {
      name: "pacha sunset",
      quantity: "900",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 2",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 3",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 4",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 5",
    },
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "parrales,FDC5",
      combos: "cascabel",
      mesa: "parrales 6",
    },
    {
      name: "mama",
      quantity: "1000",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "parrales 7",
    },
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "fernet buhero,parrales",
      combos: "cascabel",
      mesa: "parrales 8",
    },
    {
      name: "ignacio aguilar",
      quantity: "980",
      drinks: "FDC5, parrales",
      combos: "cumpleañero",
      mesa: "parrales 9",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "parrales 10",
    },
    {
      name: "pacha sunset",
      quantity: "100",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "parrales 11",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5, parrales",
      combos: "cumpleañero",
      mesa: "parrales 12",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5, parrales",
      combos: "cumpleañero",
      mesa: "parrales 13",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5,parrales",
      combos: "cumpleañero",
      mesa: "parrales 14",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5, parrales",
      combos: "cumpleañero",
      mesa: "parrales 15",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5,parrales",
      combos: "cumpleañero",
      mesa: "parrales 16",
    },
    {
      name: "pacha sunset",
      quantity: "1000",
      drinks: ", parrales",
      combos: "pachamama",
      mesa: "parrales 17",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5,parrales",
      combos: "cumpleañero",
      mesa: "parrales 18",
    },
  ],

  cholet: [
    {
      name: "mama",
      quantity: "1100",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "cholet 1",
    },
    {
      name: "pacha sunset",
      quantity: "500",
      drinks: ",parrales",
      combos: "banx",
      mesa: "cholet 2",
    },
    {
      name: "mama",
      quantity: "900",
      drinks: "parrales,",
      combos: "pachamama",
      mesa: "cholet 3",
    },
    {
      name: "pacha sunset",
      quantity: "1130",
      drinks: "FDC5,parrales",
      combos: "cumpleañero",
      mesa: "cholet 4",
    },
    {
      name: "pacha sunset",
      quantity: "700",
      drinks: "jager",
      combos: "jager",
      mesa: "cholet 5",
    },
    {
      name: "pacha sunset",
      quantity: "500",
      drinks: ",parrales",
      combos: "banx",
      mesa: "cholet 6",
    },
    {
      name: "pacha sunset",
      quantity: "500",
      drinks: "parrales,",
      combos: "banx",
      mesa: "cholet 7",
    },
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "FDC5, parrales",
      combos: "cascabel",
      mesa: "cholet 8",
    },
    {
      name: "pacha sunset",
      quantity: "450",
      drinks: "parrales",
      combos: "banx",
      mesa: "cholet 9",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "parrales,FDC5",
      combos: "cumpleañero",
      mesa: "cholet 10",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "cholet 11",
    },
    {
      name: "",
      quantity: "",
      drinks: ",",
      combos: "",
      mesa: "cholet 12",
    },
  ],

  camel: [
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "FDC5, parrales",
      combos: "cascabel",
      mesa: "camel 1",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "camel 2",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "camel 3",
    },
  ],

  extras: [
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 1",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 2",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 3",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 4",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 5",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 6",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 7",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 8",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 9",
    },
    {
      name: "",
      quantity: "",
      drinks: "",
      combos: "",
      mesa: "extras 10",
    },
  ],

  Vip: [
    {
      name: "pacha sunset",
      quantity: "700",
      drinks: "jager",
      combos: "jager",
      mesa: "Vip 1",
    },
    {
      name: "pacha sunset",
      quantity: "980",
      drinks: "FDC5,parrales",
      combos: "cumpleañero",
      mesa: "Vip 2",
    },
    {
      name: "pacha sunset",
      quantity: "800",
      drinks: "gin republica,fernet buhero",
      combos: "cascabel",
      mesa: "Vip 3",
    },
    { name: "", quantity: "", drinks: ",", combos: "", mesa: "Vip 4" },
    { name: "", quantity: "", drinks: ",", combos: "", mesa: "Vip 5" },
    { name: "", quantity: "", drinks: ",", combos: "", mesa: "Vip 6" },
  ],
};

// Lista de stickers
const stickers = {
  pacha: "icons8-table-top-view-96 (2).png",
  parrales: "icons8-table-top-view-96 (2).png",
  lounge: "icons8-table-top-view-96 (2).png",
  cholet: "icons8-table-top-view-96 (2).png",
  camel: "icons8-table-top-view-96 (2).png",
  extras: "icons8-table-top-view-96 (2).png",
  Vip: "icons8-table-top-view-96 (2).png",
};

// Definición de números de cuenta
const accountNumbers = {
  "pacha sunset": "201*****307",
  "ignacio aguilar": "150*****327",
  "natalia rodriguez": "150*****327",
  mama: "150*****327",
};

// Seleccionar los contenedores para cada área
const pachaContainer = document.getElementById("pacha-container");
const parralesContainer = document.getElementById("parrales-container");
const loungeContainer = document.getElementById("lounge-container");
const choletContainer = document.getElementById("cholet-container");
const camelContainer = document.getElementById("camel-container");
const extrasContainer = document.getElementById("extras-container");
const VipContainer = document.getElementById("Vip-container");

// Función para generar stickers
function createSticker(container, area, stickerUrl) {
  area.forEach((sticker, index) => {
    const stickerDiv = document.createElement("div");
    stickerDiv.className = "sticker";

    const img = document.createElement("img");
    img.src = stickerUrl;
    img.alt = `Sticker ${index + 1}`;

    const numberLabel = document.createElement("span");
    numberLabel.className = "sticker-number";
    numberLabel.textContent = (index + 1).toString();

    const quantityLabel = document.createElement("span");
    quantityLabel.className = "sticker-quantity";
    quantityLabel.textContent = sticker.quantity;

    const nameLabel = document.createElement("span");
    nameLabel.className = "sticker-name";
    nameLabel.textContent = sticker.name;
    nameLabel.style.display = "none";

    stickerDiv.addEventListener("mouseover", () => {
      nameLabel.style.display = "block";
    });
    stickerDiv.addEventListener("mouseout", () => {
      nameLabel.style.display = "none";
    });

    stickerDiv.appendChild(img);
    stickerDiv.appendChild(numberLabel);
    stickerDiv.appendChild(quantityLabel);
    stickerDiv.appendChild(nameLabel);
    container.appendChild(stickerDiv);
  });
}

// Generar los stickers para cada área
createSticker(pachaContainer, areas.pacha, stickers.pacha);
createSticker(parralesContainer, areas.parrales, stickers.parrales);
createSticker(loungeContainer, areas.lounge, stickers.lounge);
createSticker(choletContainer, areas.cholet, stickers.cholet);
createSticker(camelContainer, areas.camel, stickers.camel);
createSticker(extrasContainer, areas.extras, stickers.extras);
createSticker(VipContainer, areas.Vip, stickers.Vip);

function calcularTotal() {
  const calcularAreaTotal = (area) =>
    area.reduce((acc, sticker) => {
      if (sticker.name && sticker.quantity) {
        return acc + (Number(sticker.quantity) || 0);
      }
      return acc;
    }, 0);

  let totalPacha = calcularAreaTotal(areas.pacha);
  let totalParrales = calcularAreaTotal(areas.parrales);
  let totalLounge = calcularAreaTotal(areas.lounge);
  let totalCholet = calcularAreaTotal(areas.cholet);
  let totalCamel = calcularAreaTotal(areas.camel);
  let totalExtras = calcularAreaTotal(areas.extras);
  let totalVip = calcularAreaTotal(areas.Vip);

  const totalGeneral =
    totalPacha +
    totalParrales +
    totalLounge +
    totalCholet +
    totalCamel +
    totalExtras +
    totalVip;

  const totalPorNombre = {};

  [
    ...areas.pacha,
    ...areas.parrales,
    ...areas.lounge,
    ...areas.cholet,
    ...areas.camel,
    ...areas.extras,
    ...areas.Vip,
  ].forEach((sticker) => {
    const name = sticker.name;
    if (name && sticker.quantity) {
      totalPorNombre[name] =
        (totalPorNombre[name] || 0) + (Number(sticker.quantity) || 0);
    }
  });

  return {
    totalGeneral,
    totalPorNombre,
  };
}

// Función para contar total de combos y cuántos de cada tipo
function contarCombos() {
  const totalCombos = {};
  let totalCombosCount = 0;

  // Recorremos las áreas para contar los combos
  [
    ...areas.pacha,
    ...areas.parrales,
    ...areas.lounge,
    ...areas.cholet,
    ...areas.camel,
    ...areas.extras,
    ...areas.Vip,
  ].forEach((sticker) => {
    const combosList = sticker.combos
      ? sticker.combos
          .split(",")
          .map((c) => c.trim())
          .filter((c) => c)
      : []; // Filtramos entradas vacías

    combosList.forEach((combo) => {
      totalCombos[combo] = (totalCombos[combo] || 0) + 1; // Contamos cada tipo de combo
    });

    // Acumulamos el total de combos solo si hay alguno registrado
    totalCombosCount += combosList.length;
  });

  return { totalCombos, totalCombosCount };
}

// Ejemplo de uso
const { totalCombos, totalCombosCount } = contarCombos();
console.log("Total de combos:", totalCombosCount);
console.log("Cantidad por tipo de combo:", totalCombos);

// Función para contar total de bebidas y cuántas de cada tipo
function contarDrinks() {
  const totalDrinks = {};
  let totalCount = 0;

  // Recorremos las áreas para contar las bebidas
  [
    ...areas.pacha,
    ...areas.parrales,
    ...areas.lounge,
    ...areas.cholet,
    ...areas.camel,
    ...areas.extras,
    ...areas.Vip,
  ].forEach((sticker) => {
    const drinksList = sticker.drinks
      ? sticker.drinks
          .split(",")
          .map((d) => d.trim())
          .filter((d) => d)
      : []; // Filtramos entradas vacías

    drinksList.forEach((drink) => {
      totalDrinks[drink] = (totalDrinks[drink] || 0) + 1; // Contamos cada tipo de bebida
    });

    // Acumulamos el total de bebidas solo si hay alguna bebida
    totalCount += drinksList.length;
  });

  return { totalDrinks, totalCount };
}

// Función para calcular el porcentaje de ocupación de cada área
function calcularPorcentajeOcupacion() {
  const porcentajes = {};

  for (const area in areas) {
    const totalStickers = areas[area].length; // Número total de stickers en el área
    const ocupados = areas[area].filter(
      (sticker) => sticker.name && sticker.quantity,
    ).length; // Contar cuántos stickers están ocupados

    // Calculamos el porcentaje de ocupación en base a la cantidad de stickers ocupados
    porcentajes[area] = (ocupados / totalStickers) * 100;
  }

  return porcentajes;
}

function calcularExtraidoPachamama() {
  const cuentasPacha = ["ignacio aguilar", "pacha sunset"];
  let totalExtraido = 0;
  let detallesExtraidos = [];

  [
    ...areas.pacha,
    ...areas.parrales,
    ...areas.lounge,
    ...areas.cholet,
    ...areas.camel,
    ...areas.extras,
    ...areas.Vip,
  ].forEach((sticker) => {
    if (
      sticker.combos &&
      sticker.combos.includes("pachamama") &&
      cuentasPacha.includes(sticker.name)
    ) {
      const cantidad = Number(sticker.quantity);
      if (cantidad >= 500) {
        totalExtraido += 500;
        detallesExtraidos.push({
          name: sticker.name,
          cantidadExtraida: 500,
          cantidadRestante: cantidad - 500,
          mesa: sticker.mesa,
          depositadoA: sticker.name,
        });
      }
    }
  });

  return { totalExtraido, detallesExtraidos };
}

function calcularDepositoMama() {
  let totalDepositoMama = 0;
  let detallesMama = [];

  [
    ...areas.pacha,
    ...areas.parrales,
    ...areas.lounge,
    ...areas.cholet,
    ...areas.camel,
    ...areas.extras,
    ...areas.Vip,
  ].forEach((sticker) => {
    if (
      (sticker.name === "mama" ||
        sticker.name === "natalia rodriguez") &&
      sticker.combos === "pachamama"
    ) {
      const cantidad = Number(sticker.quantity);
      if (cantidad >= 500) {
        totalDepositoMama += 500;
        detallesMama.push({
          name: sticker.name,
          cantidadExtraida: 500,
          cantidadRestante: cantidad - 500,
          mesa: sticker.mesa,
        });
      }
    }
  });

  return { totalDepositoMama, detallesMama };
}

function calcularGanancias(
  areas,
  cocaColaCantidad = 0,
  schweppesCantidad = 0,
  monsterCantidad = 0,
  aguaTonicaCantidad = 0,
  simbaPomeloCantidad = 0,
  spriteCantidad = 0,
) {
  const precios = {
    "viuda descalza": 77.15,
    parrales: 65,
    "fernet branca": 98,
    "fernet buhero": 84.8,
    FDC5: 87,
    "gin republica": 103.38,
    jager: 190,
    cocaCola: 11.7,
    vodka: 96,
    "Schweppes Ginger Ale 1.5": 9.5,
    monster: 20.4,
    aguaTonica: 6.6,
    simbaPomelo: 9,
    sprite: 11.7,
  };

  let totalesDrinks = {}; // Acumular cantidades por tipo de drink
  let totalQuantity = 0; // Suma de todas las cantidades

  // Calcular totales por drink y sumar los quantity
  for (const area in areas) {
    areas[area].forEach(({ quantity, drinks, name }) => {
      // Verificar si el nombre no es "MAMA" antes de sumar la cantidad
      if (name !== "MAMA") {
        totalQuantity += parseInt(quantity) || 0;
      }

      if (drinks) {
        drinks.split(",").forEach((drink) => {
          drink = drink.trim();

          // Solo contar si el drink tiene un nombre válido
          if (drink && precios[drink]) {
            if (!totalesDrinks[drink]) {
              totalesDrinks[drink] = 0;
            }
            totalesDrinks[drink] += 1; // Contamos cada ocurrencia del drink
          }
        });
      }
    });
  }

  // Calcular ingresos por tipo de drink
  let totalGanadoDrinks = 0;
  const detalleVentas = [];
  for (const [drink, cantidad] of Object.entries(totalesDrinks)) {
    const precio = precios[drink] || 0;
    const ingreso = cantidad * precio;
    totalGanadoDrinks += ingreso;
    detalleVentas.push({ producto: drink, cantidad, ingreso });
  }

  // Calcular ingresos por Coca-Cola, Schweppes, Monster, Agua Tónica, Simba Pomelo, Sprite
  const ingresoCocaCola = cocaColaCantidad * precios.cocaCola;
  const ingresoSchweppes =
    schweppesCantidad * precios["Schweppes Ginger Ale 1.5"];
  const ingresoMonster = monsterCantidad * precios.monster;
  const ingresoAguaTonica = aguaTonicaCantidad * precios.aguaTonica;
  const ingresoSimbaPomelo = simbaPomeloCantidad * precios.simbaPomelo;
  const ingresoSprite = spriteCantidad * precios.sprite;

  totalGanadoDrinks +=
    ingresoCocaCola +
    ingresoSchweppes +
    ingresoMonster +
    ingresoAguaTonica +
    ingresoSimbaPomelo +
    ingresoSprite;

  // Agregar detalles de Coca-Cola, Schweppes, Monster, Agua Tónica, Simba Pomelo, Sprite
  detalleVentas.push({
    producto: "Coca-Cola",
    cantidad: cocaColaCantidad,
    ingreso: ingresoCocaCola,
  });
  detalleVentas.push({
    producto: "Schweppes Ginger Ale 1.5",
    cantidad: schweppesCantidad,
    ingreso: ingresoSchweppes,
  });
  detalleVentas.push({
    producto: "Monster",
    cantidad: monsterCantidad,
    ingreso: ingresoMonster,
  });
  detalleVentas.push({
    producto: "Agua Tónica",
    cantidad: aguaTonicaCantidad,
    ingreso: ingresoAguaTonica,
  });
  detalleVentas.push({
    producto: "Simba Pomelo",
    cantidad: simbaPomeloCantidad,
    ingreso: ingresoSimbaPomelo,
  });
  detalleVentas.push({
    producto: "Sprite",
    cantidad: spriteCantidad,
    ingreso: ingresoSprite,
  });

  // Calcular resultado final
  const resultado = Math.abs(totalGanadoDrinks - totalQuantity);

  return {
    totalQuantity,
    totalGanado: totalGanadoDrinks,
    resultado,
    detalleVentas,
  };
}

// Función para mostrar el total y detalles en el modal
function mostrarDetalles() {
  const totals = calcularTotal();
  const { totalDrinks } = contarDrinks();
  const { totalCombos } = contarCombos(); // Llamamos a la nueva función
  const porcentajes = calcularPorcentajeOcupacion();
  const totalNames = Object.keys(totals.totalPorNombre);
  const totalNombreTitle = document.getElementById("total-nombre-title");
  const totalContainer = document.getElementById("total-container");

  totalContainer.innerHTML = "";

  if (totalNames.length === 1) {
    const name = totalNames[0];
    const accountNumber = accountNumbers[name] || "N/A";
    const totalAmount = totals.totalGeneral;

    totalContainer.innerHTML = `
      <div class="card-credit">
        <div class="total-label">Total Registrado</div>
        <h2>${name}</h2>
       <div class="amount">${totalAmount.toLocaleString("es-ES")} bs</div>

        <div class="account-number">Cuenta: ${accountNumber}</div>
      </div>
    `;

    document.getElementById("total-nombre-container").innerHTML = "";
    document.getElementById("nombre-table").style.display = "none";
    totalNombreTitle.style.display = "none";
  } else {
    const totalPorNombreContainer = document.getElementById(
      "total-nombre-container",
    );
    totalPorNombreContainer.innerHTML = "";
    document.getElementById("nombre-table").style.display = "";
    totalNombreTitle.style.display = "";

    let totalMonto = 0;

    for (const [nombre, total] of Object.entries(totals.totalPorNombre)) {
      const accountNumber = accountNumbers[nombre] || "N/A";
      const row = document.createElement("tr");
      row.innerHTML = `<td>${nombre} (${accountNumber})</td><td>${total.toLocaleString("es-ES")} bs</td>`;
      totalPorNombreContainer.appendChild(row);
      totalMonto += total;
    }

    const totalRow = document.createElement("tr");
    totalRow.innerHTML = `<td style="font-weight: bold; color:white;">Total:</td><td style="font-weight: bold;color:white;">${totalMonto.toLocaleString("es-ES")} bs</td>`;
    totalPorNombreContainer.appendChild(totalRow);
  }

  // Contenedor para las tablas
  let containerStyle = `
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
      <style>
        /* Estilo para las celdas con un fondo elegante tipo discoteca de noche */
        #nombre-table td {
          background: linear-gradient(135deg, #1a1a2e, #3f0d3e); /* Degradado oscuro-violeta */
          color: #e0b3ff; /* Letra en violeta claro neón */
          font-weight: bold;
          text-shadow: 0 0 4px #b266ff; /* Brillito sutil al texto */
          border: 1px solid #4c0070; /* Borde fino para que resalte cada celda */
        }

        /* Responsive para pantallas pequeñas */
        @media (max-width: 768px) {
          div {
            grid-template-columns: 1fr !important;
          }

          .table {
            width: 100% !important;
            margin: 0 auto;
          }
        }
      </style>
  `;

  let combosTable = `<div><h3>Combos estrella</h3>
    <div style="display: flex; justify-content: center;">
      <table class="table">
        <thead>
          <tr>
            <th>Combo</th>
            <th>Cantidad</th>
          </tr>
        </thead>
        <tbody>`;

  let totalCombosCount = 0;

  // Ordenar por cantidad de mayor a menor
  const sortedCombos = Object.entries(totalCombos).sort(
    ([, a], [, b]) => b - a,
  );

  for (const [combo, count] of sortedCombos) {
    combosTable += `
        <tr>
          <td>${combo}</td>
          <td>${count}</td>
        </tr>`;
    totalCombosCount += count;
  }

  combosTable += `
    <tr style="font-weight: bold; color: black;">
      <td style="color: white;">Total:</td>
      <td style="color: white;">${totalCombosCount}</td>
    </tr>
  </tbody>
  </table>
  </div></div>`;

  // Obtener los detalles extraídos
  const { totalExtraido, detallesExtraidos } = calcularExtraidoPachamama();

  let pachamamaTable = `<div><h3 style="color: white;">GANANCIAS MAMA</h3>
    <div style="display: flex; justify-content: center;">
      <table class="table">
        <thead>
          <tr>
            <th>Mesa</th>
            <th>Acuerdo PachaMama</th>
            <th>Cuenta de destino</th>
          </tr>
        </thead>
        <tbody>`;

  detallesExtraidos.forEach((detalle) => {
    pachamamaTable += `
          <tr>
            <td>${detalle.mesa}</td>
            <td>${detalle.cantidadExtraida}</td>
            <td>${detalle.depositadoA}</td>
          </tr>`;
  });

  pachamamaTable += `
          <tr style="font-weight: bold; color: white;">
            <td style="color: white;">Total depositar a MAMA:</td>
            <td style="color: white;">${totalExtraido} bs</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div></div>`;

  // Llamada a la función calcularDepositoMama antes de usar 'detallesMama'
  const { totalDepositoMama, detallesMama } = calcularDepositoMama();

  let mamaTable = `<div><h3 style="color: white;">DEPOSITOS QUE MAMA DEBE REALIZAR A PACHA</h3>
    <div style="display: flex; justify-content: center;">
      <table class="table">
        <thead>
          <tr>
            <th>Mesa</th>
            <th>Acuerdo PachaMama</th>
            <th>Cuenta</th>
          </tr>
        </thead>
        <tbody>`;

  detallesMama.forEach((detalle) => {
    mamaTable += `
          <tr>
            <td>${detalle.mesa}</td>
            <td>${detalle.cantidadExtraida}</td>
            <td>${detalle.name}</td>
          </tr>`;
  });

  mamaTable += `
          <tr style="font-weight: bold; color: white;">
            <td style="color: white;">Total que deben depositar a PACHA:</td>
            <td style="color: white;">${totalDepositoMama} bs</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div></div>`;

  let drinksTable = `<div><h3>BEBIDAS</h3>
    <div style="display: flex; justify-content: center;">
      <table class="table">
        <thead>
          <tr>
            <th>Bebida</th>
            <th>Cantidad</th>
          </tr>
        </thead>
        <tbody>`;

  let totalDrinksCount = 0;

  // Ordenar por cantidad de mayor a menor
  const sortedDrinks = Object.entries(totalDrinks).sort(
    ([, a], [, b]) => b - a,
  );

  for (const [drink, count] of sortedDrinks) {
    drinksTable += `
          <tr>
            <td>${drink}</td>
            <td>${count}</td>
          </tr>`;
    totalDrinksCount += count;
  }

  drinksTable += `
          <tr style="font-weight: bold; color: white;">
            <td style="color: white;">Total:</td>
            <td style="color: white;">${totalDrinksCount}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>`;

  // Agregamos todas las tablas al contenedor
  totalContainer.innerHTML +=
    containerStyle +
    combosTable +
    pachamamaTable +
    mamaTable +
    drinksTable +
    "</div>";

  // Crear un objeto para contar las mesas por combo
  const comboCounts = {
    cumpleañero: 0,
    pacha: 0,
    cascabel: 0,
    banx: 0,
    jager: 0,
    pachamama: 0,
  };

  // Contar las mesas por combo en todas las áreas especificadas
  areas.pacha
    .concat(areas.lounge, areas.parrales, areas.cholet, areas.camel, areas.Vip)
    .forEach((sticker) => {
      const combo = sticker.combos; // Obtener el combo
      // Solo contar los combos mencionados
      if (comboCounts.hasOwnProperty(combo)) {
        comboCounts[combo]++;
      }
    });

  // Mostrar el conteo de las mesas por combo
  const countContainer = document.getElementById("count-container");
  countContainer.innerHTML = `
    <div class="card-container">
      ${Object.keys(comboCounts)
        .map(
          (combo) => `
        <div class="card">
          <div class="card-content">
            <div class="card-title">Mesas ${combo}:</div>
            <div class="card-value">${comboCounts[combo]}</div>
          </div>
        </div>
      `,
        )
        .join("")}
    </div>
  `;

  // Mostrar porcentajes de ocupación
  const porcentajeContainer = document.createElement("div");
  porcentajeContainer.className = "porcentaje-container"; // Clase para CSS
  porcentajeContainer.innerHTML = `
    <h3>Porcentaje de áreas Vendidas</h3>
    <div class="porcentaje-area">
      <div class="area pacha">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.pacha.toFixed(2)}%;"></div>
        <p>Pacha: ${porcentajes.pacha.toFixed(2)}%</p>
      </div>
      <div class="area parrales">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.parrales.toFixed(2)}%;"></div>
        <p>Parrales: ${porcentajes.parrales.toFixed(2)}%</p>
      </div>
      <div class="area lounge">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.lounge.toFixed(2)}%;"></div>
        <p>lounge: ${porcentajes.lounge.toFixed(2)}%</p>
         </div>
       <div class="area cholet">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.cholet.toFixed(2)}%;"></div>
        <p>Cholet: ${porcentajes.cholet.toFixed(2)}%</p>
      </div>
      <div class="area camel">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.camel.toFixed(2)}%;"></div>
        <p>Camel: ${porcentajes.camel.toFixed(2)}%</p>
      </div>
      <div class="area extras">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.extras.toFixed(2)}%;"></div>
        <p>Extras: ${porcentajes.extras.toFixed(2)}%</p>
      </div>
      <div class="area Vip">
        <div class="porcentaje-circle" style="--porcentaje: ${porcentajes.Vip.toFixed(2)}%;"></div>
        <p>Vip:     ${porcentajes.Vip.toFixed(2)}%</p>
      </div>
    </div>
  `;

  countContainer.appendChild(porcentajeContainer);
  document.getElementById("modal").style.display = "block";
  modal.classList.add("show");
}

// Cerrar el modal al hacer clic en la X
document.getElementById("close-modal").addEventListener("click", () => {
  modal.classList.remove("show");
  modal.classList.add("hide");

  modal.addEventListener(
    "animationend",
    () => {
      document.getElementById("modal").style.display = "none";
      modal.classList.remove("hide");
    },
    { once: true },
  );
});

// Opción 1 del menú
document.getElementById("opcion-1").addEventListener("click", () => {
  mostrarDetalles();
  sideMenu.classList.remove("open");
});

// Función para mostrar/ocultar el menú
const menuSticker = document.getElementById("top-left-sticker");
const sideMenu = document.getElementById("side-menu");

menuSticker.addEventListener("click", (event) => {
  sideMenu.classList.toggle("open");
  event.stopPropagation();
});

// Cerrar el menú si se hace clic fuera de él
document.addEventListener("click", (event) => {
  if (
    sideMenu.classList.contains("open") &&
    !sideMenu.contains(event.target) &&
    !menuSticker.contains(event.target)
  ) {
    sideMenu.classList.remove("open");
  }
});

function mostrarGanancias() {
  // Puedes cambiar los valores de Coca-Cola, Schweppes y Monster aquí
  const cocaColaCantidad = 22;
  const schweppesCantidad = 49;
  const monsterCantidad = 1; // Cantidad de Monster
  const aguaTonicaCantidad = 4; // Cantidad de Agua Tónica
  const simbaPomeloCantidad = 4; // Cantidad de Simba Pomelo
  const spriteCantidad = 0; // Cantidad de Sprite

  const { totalQuantity, totalGanado, resultado, detalleVentas } =
    calcularGanancias(
      areas,
      cocaColaCantidad,
      schweppesCantidad,
      monsterCantidad,
      aguaTonicaCantidad,
      simbaPomeloCantidad,
      spriteCantidad,
    );

  const gananciasContainer = document.getElementById("ganancias-container");

  // Limpiar contenido previo del modal
  gananciasContainer.innerHTML = "";

  // URLs de los íconos personalizados para cada tarjeta
  const iconoQuantityUrl =
    "https://img.icons8.com/?size=100&id=63196&format=png&color=000000";
  const iconoGanadoUrl =
    "https://img.icons8.com/?size=100&id=13013&format=png&color=000000";
  const iconoResultadoUrl =
    "https://img.icons8.com/?size=100&id=AyHHKGHt204t&format=png&color=000000";

  // Crear tarjetas con íconos personalizados
  const tarjetasHtml = `
    <div class="tarjeta">
      <img src="${iconoQuantityUrl}" alt="Total Quantity Icon" class="icono-quantity">
      <h3>Total De Ingresos</h3>
      <p>${totalQuantity.toLocaleString()} Bs</p>
    </div>
    <div class="tarjeta">
      <img src="${iconoGanadoUrl}" alt="Total Ganado Icon" class="icono-ganado">
      <h3>Inversión</h3>
      <p>${totalGanado.toLocaleString()} Bs</p>
    </div>
    <div class="tarjeta">
      <img src="${iconoResultadoUrl}" alt="Ganancias Neta Icon" class="icono-resultado">
      <h3>Ganancias Neta</h3>
      <p>${resultado.toLocaleString()} Bs</p>
    </div>
  `;

  gananciasContainer.innerHTML += tarjetasHtml;

  // Mostrar mensaje o tabla según las cantidades
  let detalleVentasHtml = `
    <div class="detalle-ventas">
      <h3>Detalles De Inversión</h3>
      <style>
        /* Asegurar que la tabla sea más ancha en dispositivos móviles */
        @media (max-width: 768px) {
          .table {
            width: 103% !important;
            margin: 0 auto;
            transform: translateX(-2%); /* Desplaza 10% hacia la izquierda */
          }
        }
      </style>
  `;

  if (
    cocaColaCantidad === 0 &&
    schweppesCantidad === 0 &&
    monsterCantidad === 0
  ) {
    detalleVentasHtml += `<p>No hay productos añadidos.</p>`;
  } else {
    detalleVentasHtml += `
      <table class="table">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad Usada</th>
            <th>Costo Invertido</th>
          </tr>
        </thead>
        <tbody>
    `;

    // Filtrar las ventas donde la cantidad es mayor que 0
    detalleVentas.forEach((venta) => {
      if (venta.cantidad > 0) {
        detalleVentasHtml += `
          <tr>
            <td>${venta.producto}</td>
            <td>${venta.cantidad}</td>
            <td>${venta.ingreso} Bs</td>
          </tr>
        `;
      }
    });

    detalleVentasHtml += `
        </tbody>
      </table>
    `;
  }

  detalleVentasHtml += `</div>`;

  // Agregar el HTML generado al contenedor
  gananciasContainer.innerHTML += detalleVentasHtml;

  // Mostrar el modal
  const modal = document.getElementById("modal-ganancias");
  modal.style.display = "block";
  modal.classList.add("show");
}

// Asociar el evento al botón "ver ganancias"
document.getElementById("ver-ganancias").addEventListener("click", () => {
  mostrarGanancias();
  sideMenu.classList.remove("open");
});

// Cerrar el modal de ganancias al hacer clic en la X
document
  .getElementById("close-ganancias-modal")
  .addEventListener("click", () => {
    const gananciasModal = document.getElementById("modal-ganancias");
    gananciasModal.classList.remove("show");
    gananciasModal.classList.add("hide");

    gananciasModal.addEventListener(
      "animationend",
      () => {
        gananciasModal.style.display = "none";
        gananciasModal.classList.remove("hide");
      },
      { once: true },
    );
  });
